---
title: 监听dom元素的宽高属性变化
date: 2019-10-21 16:51:47
tags: [javascript]
categories: 前端笔记
---

在日常开发中，当涉及到一些动态效果，或者与动态属性相关的交互体验的开发时，其实比较常接触到需要监听dom宽度啦高度啦，的数值变化的场景，可能是需要时刻知道，元素的属性值，或者获取元素属性值变化的时机。
废话不多说，我这里常用的监听dom元素属性变化，主要使用三个方法。

## 1、MutationObserver 
先看下mdn上的介绍和示例
>[MutationObserver](https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver)接口提供了监视对DOM树所做更改的能力。它被设计为旧的Mutation Events功能的替代品，该功能是DOM3 Events规范的一部分。
>
>
> [MutationObserver](https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver)的**observe**()方法配置了MutationObserver对象的回调方法以开始接收与给定选项匹配的DOM变化的通知。 根据配置，这个观察者会观察DOM树中的单个[Node](https://developer.mozilla.org/zh-CN/docs/Web/API/Node)，或者指定的节点及其某些或者所有的子孙节点。
>要停止这个MutationObserver （以便不再触发它的回调方法），需要调用[MutationObserver.disconnect](https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver/disconnect)()方法。
>

``` bash

var elementToObserve = document.querySelector("#targetElementId");

var observer = new MutationObserver(function() {
    console.log('callback that runs when observer is triggered');
});

observer.observe(elementToObserve, {subtree: true, childList: true});
```

在new MutationObserver的时候，把监听到变化后想要执行的回调传入，然后，调用observe方法，配置两个参数，分别是监听的目标dom元素和要监听属性的配置项，该配置项可配置如下：

>
>当你调用observe()方法时，childList，attributes或者characterData中至少有一个必须为true，否则将抛出TypeError异常。
>**[attributeFilter](https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserverInit/attributeFilter)** 可选
>要监视的特定属性名称的数组。如果未包含此属性，则对所有属性的更改都会触发变动通知。无默认值。
>**[attributeOldValue](https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserverInit/attributeOldValue)** 可选
>当监视节点的属性改动时，将此属性设为true 将记录任何有改动的属性的上一个值。有关观察属性更改和值记录的详细信息，详见Monitoring attribute values in MutationObserver。无默认值。
>attributes 可选
>设为true以观察受监视元素的属性值变更。默认值为false。
>characterData 可选
>设为true以监视指定目标节点或子节点树中节点所包含的字符数据的变化。无默认值。
>characterDataOldValue 可选
>设为true以在文本在受监视节点上发生更改时记录节点文本的先前值。详情及例子，请查看Monitoring text content changes in MutationObserver。无默认值。
>childList 可选
>设为true以监视目标节点（如果subtree为true，则包含子孙节点）添加或删除新的子节点。默认值为false。
>subtree 可选
>设为true以扩展监视范围到目标节点下的整个子树的所有节点。MutationObserverInit的其他值都会作用于此子树下的所有节点，而不仅仅只作用于目标节点。默认值为false。
>